---
title: "Data Sources"
author: "Daniel Truver"
date: "11/6/2018"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
library(dplyr)
library(stringr)
```

```{r}
cand = read.csv("cand_2018.csv", stringsAsFactors = FALSE)
house = cand %>%
  filter(Cand_Office == "H") %>%
  filter(Cand_Party_Affiliation == "DEM")
states = lapply(state.abb, function(st){
  filename = paste0(st, "_all.csv")
  read.csv(filename, stringsAsFactors = FALSE)
})
names(states) = state.abb
```

```{r}
t = states[["NC"]]
names_t = names(t)
not_moe = !str_detect(names_t, "MOE")
t = t[,not_moe]
districts = names(t)
newnames = str_remove(districts, ".Estimate") %>%
  str_remove(., "District.") %>%
  paste0("NC_", .)
colnames(t) = newnames
colnames(t)[1:3] = c("topic", "subject", "title")
new_t = t %>%
  filter(subject != "Selected Monthly Owner Costs(SMOC)") %>%
  filter(subject != "Place of Birth") %>%
  filter(subject != "Ancestry") %>%
  filter(subject != "Disability Status of the Civilian Noninstitutionalized Population") %>%
  filter(subject != "Residence 1 Year Ago") %>%
  filter(subject != "Commuting to Work") %>%
  filter(subject != "Year Householder Moved into Unit") %>%
  filter(subject != "Mortgage Status") %>%
  filter(subject != "") %>%
  filter(subject != "Subject") %>%
  select(-topic)
new_t[,-(1:2)] = apply(new_t[,-(1:2)], 2, as.numeric)
```

```{r sex_and_age}
new_sex_and_age = new_t %>% filter(subject == "Sex and Age")
pops = new_sex_and_age
for(i in 3:ncol(pops)){
  pops[-17,i] = c(pops[1,i], pops[-c(1,17),i]/pops[1,i])
}
sex_and_age = which(new_t$subject == "Sex and Age")
new_t[sex_and_age,] = pops
```

```{r race}
new_race = new_t %>% filter(subject == "Race")
for(i in 3:ncol(new_race)){
  new_race[,i] = c(new_race[1,i], new_race[-1,i]/new_race[1,i])
}
race = which(new_t$subject == "Race")
new_t[race,] = new_race
```

```{r hispanic}
new_hisp = new_t %>% filter(subject == "Hispanic or Latino and Race")
for(i in 3:ncol(new_hisp)){
  new_hisp[,i] = c(new_hisp[1,i], new_hisp[-1,i]/new_race[1,i])
}
hisp = which(new_t$subject == "Hispanic or Latino and Race")
new_t[hisp,] = new_hisp
```

```{r veterans}
new_vet = new_t %>% filter(subject == "Veteran Status")
for(i in 3:ncol(new_vet)){
  total = new_vet[1,i]
  new_vet[,i] = c(total, new_vet[-1,i]/total)
}
vet = which(new_t$subject == "Veteran Status")
new_t[vet,] = new_vet
``` 

```{r employment}
new_emp = new_t %>% filter(subject == "Employment Status")
for(i in 3:ncol(new_emp)){
  total = new_emp[1,i]
  exempt = NULL
  new_emp[-exempt,i] = c(total, new_emp[-c(1,17),i]/total)
}
```

nominees: http://clerk.house.gov/member_info/election.aspx

https://www.census.gov/mycd/

https://www.fec.gov/data/advanced/?tab=candidates

have to JAGS